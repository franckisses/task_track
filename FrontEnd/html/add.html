<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADD Task</title>
</head>
<body>
    <h2>Task Add</h2>
    <hr>
    <span>Creator: <span id="my_login"></span></span>
    <p>Project Country:<input id="country" type="text"></p>
    <p>Customer Name:<input id="customer" type="text"></p>
    <p>Task Name:<input id="task-name" type="text"></p>
    <p>Task Desc:<input id="task-desc" type="text"></p>
    <p>Design File:<input id="desc-detail" type="file"></p>
    <button>submit</button>
</body>
<script>
    // 1. 检查如果没有登录的话，那么重定向去登录页面
    // 2. 如果登录的话，那么发送请求验证是否还在有效期呢。不在有效期的话，让重新登录
    var loginName = window.localStorage.getItem('username');
    if (loginName){
        $('#my_login').html(loginName)
    }
    function submit(){
        project_country = $('#country').val()
        customer_name = $('#customer').val()
        task_name = $('task-name').val()
        task_desc = $('task-desc').val()
        desc_file = $('desc-deatil').files[0]
        data = {'username': username, 'password':password}
        if (username && password){
            $.ajax({
                type: 'POST',
                url: BASEURL + 'tokens',
                contentType: 'application/json',
                data: JSON.stringify(data),
                success: function (result){
                    console.log(result)
                    if (result.code==200){
                        confirm('登录成功!')
                        localStorage.setItem('username', result.username);
                        localStorage.setItem('token', result.data.token);
                        window.location.href='index.html'
                    } else {
                        alert(result.error)
                    }
                }

            })
        }
    }
</script>
</html>